<!-- forms.html -->
{{if .Success}}
    <h1>Successfully submitted</h1>
{{else}}
    <h1>Create new patient record</h1>
    <form method="POST">
        <label>patient_id:</label><br />
        <input type="text" name="pid" id ="pid"><br />  
        <p id="warning" style="display: none; color: red;">PATIENT ID ALREADY EXISTS</p><br />
        <span>
            <input type="radio" id="male" name="gender" value="male">
            <label for="male">Male</label><br>
            <input type="radio" id="female" name="gender" value="female">
            <label for="female">Female</label><br>
            <input type="radio" id="other" name="gender" value="other">
            <label for="other">Other</label><br />
        </span><br /><br />
        <label>year of diagnosis:</label><br />
        <input type="text" name="diagnosis"><br /><br />
        <input type="submit" id="submit">
    </form>
    
    <p id="existingPids" style="display: none;">{{.Pids}}</p>
    <script>
        const input = document.getElementById("pid");
        const warn = document.getElementById('warning');
        const pids = document.getElementById("existingPids").innerHTML;
        const submit = document.getElementById("submit");

        input.addEventListener('change', updateValue);

        function updateValue(e) {
            console.log("called");
            console.log(pids);
            x = e.target.value;
            console.log(x)
            if (pids.includes(x)) {                
                warn.style.display = "block";
                submit.disabled = true;
                console.log("BAD");      
            } else {
                warn.style.display = "none";
                submit.disabled = false;
                console.log("GOOD");
            }        
        }
    </script>
{{end}}